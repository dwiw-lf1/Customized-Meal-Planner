<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>每周营养餐配餐系统</title>
    <!-- 使用CDN链接确保字体图标加载 -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary-green: #2e7d32;
            --light-green: #4caf50;
            --background-green: #f1f8e9;
            --text-dark: #2e3a24;
            --text-light: #5a6c55;
            --card-bg: #ffffff;
            --day-color: #388e3c;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', 'Microsoft YaHei', sans-serif;
        }
        
        body {
            background-color: var(--background-green);
            color: var(--text-dark);
            line-height: 1.6;
            min-height: 100vh;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }
        
        header {
            text-align: center;
            padding: 30px 20px;
            background-color: var(--primary-green);
            color: white;
            border-radius: 12px;
            margin-bottom: 30px;
            box-shadow: 0 4px 12px rgba(46, 125, 50, 0.2);
        }
        
        h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
        }
        
        .subtitle {
            font-size: 1.1rem;
            opacity: 0.9;
            max-width: 800px;
            margin: 0 auto;
        }
        
        .main-content {
            display: grid;
            grid-template-columns: 1fr 3fr;
            gap: 30px;
        }
        
        @media (max-width: 1100px) {
            .main-content {
                grid-template-columns: 1fr;
            }
        }
        
        .client-form, .week-plan {
            background-color: var(--card-bg);
            border-radius: 12px;
            padding: 25px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.08);
            min-height: 500px;
        }
        
        .section-title {
            color: var(--primary-green);
            border-bottom: 2px solid var(--light-green);
            padding-bottom: 10px;
            margin-bottom: 20px;
            font-size: 1.5rem;
            display: flex;
            align-items: center;
        }
        
        .section-title i {
            margin-right: 10px;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--text-dark);
        }
        
        input, select {
            width: 100%;
            padding: 12px 15px;
            border: 1px solid #c8e6c9;
            border-radius: 8px;
            font-size: 1rem;
            transition: border-color 0.3s;
            background-color: white;
        }
        
        input:focus, select:focus {
            outline: none;
            border-color: var(--primary-green);
            box-shadow: 0 0 0 2px rgba(76, 175, 80, 0.2);
        }
        
        .btn {
            background-color: var(--primary-green);
            color: white;
            border: none;
            padding: 14px 20px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 600;
            transition: background-color 0.3s;
            width: 100%;
            margin-top: 10px;
        }
        
        .btn:hover {
            background-color: var(--light-green);
        }
        
        .btn i {
            margin-right: 8px;
        }
        
        .week-nav {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 1px solid #e8f5e9;
        }
        
        .week-title {
            font-size: 1.6rem;
            color: var(--primary-green);
            font-weight: 700;
        }
        
        .day-selector {
            display: flex;
            overflow-x: auto;
            gap: 10px;
            margin-bottom: 25px;
            padding-bottom: 10px;
        }
        
        .day-btn {
            padding: 12px 20px;
            background-color: #e8f5e9;
            border: 2px solid #c8e6c9;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            color: var(--text-light);
            white-space: nowrap;
            transition: all 0.3s;
            min-width: 100px;
            text-align: center;
        }
        
        .day-btn.active {
            background-color: var(--primary-green);
            color: white;
            border-color: var(--primary-green);
        }
        
        .day-btn:hover:not(.active) {
            background-color: #d4edda;
        }
        
        .day-content {
            display: none;
        }
        
        .day-content.active {
            display: block;
            animation: fadeIn 0.5s;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        .day-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid var(--light-green);
        }
        
        .day-name {
            font-size: 1.8rem;
            color: var(--day-color);
            font-weight: 700;
        }
        
        .day-date {
            font-size: 1.1rem;
            color: var(--text-light);
            background-color: #e8f5e9;
            padding: 6px 15px;
            border-radius: 20px;
        }
        
        .meals-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .meal-card {
            background-color: #f9fdf8;
            border-radius: 10px;
            padding: 20px;
            border-left: 5px solid var(--light-green);
            transition: transform 0.3s;
        }
        
        .meal-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.1);
        }
        
        .meal-title {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            color: var(--primary-green);
        }
        
        .meal-name {
            font-size: 1.3rem;
            font-weight: 700;
        }
        
        .meal-time {
            font-size: 0.9rem;
            background-color: #e8f5e9;
            padding: 4px 10px;
            border-radius: 20px;
        }
        
        .food-item {
            display: flex;
            justify-content: space-between;
            padding: 8px 0;
            border-bottom: 1px dashed #e0e0e0;
        }
        
        .food-name {
            font-weight: 600;
        }
        
        .food-weight {
            color: var(--text-light);
        }
        
        .nutrients {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 10px;
            margin-top: 15px;
            padding-top: 15px;
            border-top: 1px solid #e8f5e9;
        }
        
        .nutrient {
            text-align: center;
            padding: 8px;
            background-color: #f1f8e9;
            border-radius: 6px;
        }
        
        .nutrient-value {
            font-weight: 700;
            color: var(--primary-green);
            font-size: 1.1rem;
        }
        
        .nutrient-label {
            font-size: 0.85rem;
            color: var(--text-light);
        }
        
        .recipe-btn {
            display: inline-block;
            background-color: #e8f5e9;
            color: var(--primary-green);
            padding: 8px 15px;
            border-radius: 6px;
            text-decoration: none;
            font-weight: 600;
            margin-top: 15px;
            transition: all 0.3s;
            cursor: pointer;
        }
        
        .recipe-btn:hover {
            background-color: var(--light-green);
            color: white;
        }
        
        .weekly-summary {
            background-color: #e8f5e9;
            border-radius: 10px;
            padding: 20px;
            margin-top: 30px;
        }
        
        .summary-title {
            font-size: 1.3rem;
            color: var(--primary-green);
            margin-bottom: 15px;
        }
        
        .summary-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
        }
        
        .summary-item {
            background-color: white;
            padding: 15px;
            border-radius: 8px;
            text-align: center;
        }
        
        .summary-value {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--primary-green);
        }
        
        .summary-label {
            font-size: 0.9rem;
            color: var(--text-light);
            margin-top: 5px;
        }
        
        footer {
            text-align: center;
            margin-top: 40px;
            padding-top: 20px;
            border-top: 1px solid #c8e6c9;
            color: var(--text-light);
            font-size: 0.9rem;
        }
        
        .guideline-ref {
            background-color: #e8f5e9;
            padding: 15px;
            border-radius: 8px;
            margin-top: 20px;
            font-size: 0.9rem;
        }
        
        .loading {
            display: none;
            text-align: center;
            padding: 40px;
            color: var(--primary-green);
        }
        
        .loading.active {
            display: block;
        }
        
        .week-plan-placeholder {
            text-align: center;
            padding: 60px 20px;
            color: var(--text-light);
        }
        
        .week-plan-placeholder i {
            font-size: 4rem;
            margin-bottom: 20px;
            color: #c8e6c9;
        }
        
        .logo {
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 15px;
        }
        
        .logo i {
            font-size: 2.5rem;
            margin-right: 15px;
        }
        
        .print-btn {
            background-color: #ff9800;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 600;
            margin-left: 10px;
            transition: background-color 0.3s;
        }
        
        .print-btn:hover {
            background-color: #f57c00;
        }
        
        /* GitHub Pages特定修复 */
        @media print {
            .btn, .print-btn {
                display: none !important;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <div class="logo">
                <i class="fas fa-calendar-week"></i>
                <h1>每周营养餐配餐系统</h1>
            </div>
            <p class="subtitle">基于2022版《中国居民膳食指南》与《你是你吃出来的》营养学原理，为您提供一周七天个性化饮食方案</p>
        </header>
        
        <div class="main-content">
            <div class="client-form">
                <h2 class="section-title"><i class="fas fa-user-circle"></i> 客户信息</h2>
                
                <div class="form-group">
                    <label for="age"><i class="fas fa-birthday-cake"></i> 年龄</label>
                    <input type="number" id="age" min="1" max="120" value="30">
                </div>
                
                <div class="form-group">
                    <label for="gender"><i class="fas fa-venus-mars"></i> 性别</label>
                    <select id="gender">
                        <option value="male">男性</option>
                        <option value="female">女性</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="weight"><i class="fas fa-weight"></i> 体重 (kg)</label>
                    <input type="number" id="weight" min="20" max="200" step="0.5" value="65">
                </div>
                
                <div class="form-group">
                    <label for="work"><i class="fas fa-briefcase"></i> 工作类型</label>
                    <select id="work">
                        <option value="sedentary">久坐少动（办公室职员等）</option>
                        <option value="light">轻体力劳动（教师、售货员等）</option>
                        <option value="moderate" selected>中体力劳动（学生、司机等）</option>
                        <option value="heavy">重体力劳动（建筑工人、运动员等）</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="exercise"><i class="fas fa-running"></i> 运动频率</label>
                    <select id="exercise">
                        <option value="none">几乎不运动</option>
                        <option value="light" selected>每周1-2次</option>
                        <option value="moderate">每周3-5次</option>
                        <option value="heavy">每周6-7次</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="diet-type"><i class="fas fa-apple-alt"></i> 饮食偏好</label>
                    <select id="diet-type">
                        <option value="balanced" selected>均衡饮食</option>
                        <option value="high-protein">高蛋白饮食</option>
                        <option value="low-carb">低碳水饮食</option>
                        <option value="vegetarian">素食</option>
                    </select>
                </div>
                
                <button class="btn" id="generate-btn">
                    <i class="fas fa-calendar-alt"></i> 生成一周营养餐单
                </button>
                
                <div class="guideline-ref">
                    <p><strong>参考依据：</strong></p>
                    <p>1. 2022版《中国居民膳食指南》平衡膳食八准则</p>
                    <p>2. 夏萌《你是你吃出来的》营养学原理</p>
                    <p>3. 每周食物多样性原则，确保营养全面</p>
                </div>
            </div>
            
            <div class="week-plan">
                <div class="week-nav">
                    <div class="week-title">本周营养餐单</div>
                    <div>
                        <button class="print-btn" id="print-btn">
                            <i class="fas fa-print"></i> 打印本周餐单
                        </button>
                    </div>
                </div>
                
                <div class="day-selector" id="day-selector">
                    <!-- 日期按钮将通过JS动态生成 -->
                </div>
                
                <div class="loading" id="loading">
                    <i class="fas fa-spinner fa-spin"></i>
                    <p>正在根据您的信息生成一周营养餐单...</p>
                    <p>这可能需要几秒钟时间</p>
                </div>
                
                <div id="week-content">
                    <div class="week-plan-placeholder">
                        <i class="fas fa-calendar-week"></i>
                        <h3>等待生成一周餐单</h3>
                        <p>请填写左侧客户信息，点击"生成一周营养餐单"按钮，系统将根据您的个人情况为您定制一周七天的完整营养餐单。</p>
                        <p>餐单将确保食物多样性，满足每日营养需求，并符合2022版《中国居民膳食指南》标准。</p>
                    </div>
                </div>
            </div>
        </div>
        
        <footer>
            <p>每周营养餐配餐系统 &copy; 2023 | 本系统推荐内容仅供参考，具体饮食请咨询专业营养师</p>
            <p>设计依据：2022版《中国居民膳食指南》 | 夏萌《你是你吃出来的》</p>
        </footer>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const generateBtn = document.getElementById('generate-btn');
            const loading = document.getElementById('loading');
            const weekContent = document.getElementById('week-content');
            const daySelector = document.getElementById('day-selector');
            const printBtn = document.getElementById('print-btn');
            
            // 当前显示的星期几（0=星期一，1=星期二，...）
            let currentDayIndex = 0;
            
            generateBtn.addEventListener('click', function() {
                // 获取用户输入
                const age = parseInt(document.getElementById('age').value);
                const gender = document.getElementById('gender').value;
                const weight = parseFloat(document.getElementById('weight').value);
                const work = document.getElementById('work').value;
                const exercise = document.getElementById('exercise').value;
                const dietType = document.getElementById('diet-type').value;
                
                // 验证输入
                if (!age || age < 1 || age > 120) {
                    alert('请输入有效的年龄（1-120岁）');
                    return;
                }
                
                if (!weight || weight < 20 || weight > 200) {
                    alert('请输入有效的体重（20-200kg）');
                    return;
                }
                
                // 显示加载状态
                loading.classList.add('active');
                weekContent.innerHTML = '';
                daySelector.innerHTML = '';
                
                // 模拟API调用延迟
                setTimeout(() => {
                    // 生成一周餐单
                    const weekPlan = generateWeekPlan(age, gender, weight, work, exercise, dietType);
                    
                    // 显示餐单
                    loading.classList.remove('active');
                    weekContent.innerHTML = weekPlan;
                    
                    // 生成日期选择器
                    generateDaySelector();
                    
                    // 默认显示第一天
                    showDay(0);
                }, 1500);
            });
            
            // 打印功能
            printBtn.addEventListener('click', function() {
                window.print();
            });
            
            // 生成日期选择器
            function generateDaySelector() {
                const days = ['星期一', '星期二', '星期三', '星期四', '星期五', '星期六', '星期日'];
                
                days.forEach((day, index) => {
                    const dayBtn = document.createElement('button');
                    dayBtn.className = `day-btn ${index === 0 ? 'active' : ''}`;
                    dayBtn.textContent = day;
                    dayBtn.dataset.day = index;
                    
                    dayBtn.addEventListener('click', function() {
                        // 更新活动按钮
                        document.querySelectorAll('.day-btn').forEach(btn => {
                            btn.classList.remove('active');
                        });
                        this.classList.add('active');
                        
                        // 显示对应日期的内容
                        showDay(parseInt(this.dataset.day));
                    });
                    
                    daySelector.appendChild(dayBtn);
                });
            }
            
            // 显示特定日期的内容
            function showDay(dayIndex) {
                currentDayIndex = dayIndex;
                
                // 隐藏所有日期内容
                document.querySelectorAll('.day-content').forEach(content => {
                    content.classList.remove('active');
                });
                
                // 显示选中的日期内容
                const selectedDay = document.getElementById(`day-${dayIndex}`);
                if (selectedDay) {
                    selectedDay.classList.add('active');
                }
            }
            
            // 计算未来一周的日期
            function getWeekDates() {
                const dates = [];
                const today = new Date();
                const dayOfWeek = today.getDay(); // 0=星期日, 1=星期一, ...
                
                // 计算本周一的日期
                let monday = new Date(today);
                monday.setDate(today.getDate() - (dayOfWeek === 0 ? 6 : dayOfWeek - 1));
                
                for (let i = 0; i < 7; i++) {
                    const date = new Date(monday);
                    date.setDate(monday.getDate() + i);
                    
                    const month = date.getMonth() + 1;
                    const day = date.getDate();
                    
                    dates.push(`${month}月${day}日`);
                }
                
                return dates;
            }
            
            // 生成一周餐单的函数
            function generateWeekPlan(age, gender, weight, work, exercise, dietType) {
                // 计算基础代谢和每日所需能量
                const bmr = calculateBMR(age, gender, weight);
                const activityFactor = getActivityFactor(work, exercise);
                const dailyCalories = Math.round(bmr * activityFactor);
                
                // 根据饮食偏好调整能量分配
                const {proteinRatio, carbRatio, fatRatio} = getDietRatios(dietType);
                
                // 获取一周日期
                const weekDates = getWeekDates();
                const dayNames = ['星期一', '星期二', '星期三', '星期四', '星期五', '星期六', '星期日'];
                
                // 生成一周数据
                let weekHTML = '';
                let weeklySummary = {
                    totalCalories: 0,
                    totalProtein: 0,
                    totalCarbs: 0,
                    totalFat: 0,
                    foodVariety: new Set()
                };
                
                for (let i = 0; i < 7; i++) {
                    const dayData = generateDayMeals(i, dailyCalories, dietType, age, gender);
                    
                    weekHTML += `
                        <div class="day-content" id="day-${i}">
                            <div class="day-header">
                                <div class="day-name">${dayNames[i]}</div>
                                <div class="day-date">${weekDates[i]}</div>
                            </div>
                            
                            <div class="meals-container">
                                ${dayData.meals}
                            </div>
                            
                            <div class="daily-summary">
                                <h3 class="summary-title">${dayNames[i]}营养汇总</h3>
                                <div class="summary-grid">
                                    <div class="summary-item">
                                        <div class="summary-value">${dayData.totalCalories} kcal</div>
                                        <div class="summary-label">总能量</div>
                                    </div>
                                    <div class="summary-item">
                                        <div class="summary-value">${dayData.totalProtein}g</div>
                                        <div class="summary-label">蛋白质</div>
                                    </div>
                                    <div class="summary-item">
                                        <div class="summary-value">${dayData.totalCarbs}g</div>
                                        <div class="summary-label">碳水化合物</div>
                                    </div>
                                    <div class="summary-item">
                                        <div class="summary-value">${dayData.totalFat}g</div>
                                        <div class="summary-label">脂肪</div>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="guideline-ref" style="margin-top: 20px;">
                                <p><strong>${dayNames[i]}饮食重点：</strong> ${dayData.dietFocus}</p>
                            </div>
                        </div>
                    `;
                    
                    // 更新周汇总数据
                    weeklySummary.totalCalories += dayData.totalCalories;
                    weeklySummary.totalProtein += dayData.totalProtein;
                    weeklySummary.totalCarbs += dayData.totalCarbs;
                    weeklySummary.totalFat += dayData.totalFat;
                    
                    // 添加食物种类（简化处理）
                    dayData.foodItems.forEach(item => weeklySummary.foodVariety.add(item));
                }
                
                // 添加周汇总
                weekHTML += `
                    <div class="weekly-summary">
                        <h3 class="summary-title">本周营养汇总</h3>
                        <div class="summary-grid">
                            <div class="summary-item">
                                <div class="summary-value">${Math.round(weeklySummary.totalCalories / 7)} kcal</div>
                                <div class="summary-label">日均能量</div>
                            </div>
                            <div class="summary-item">
                                <div class="summary-value">${Math.round(weeklySummary.totalProtein / 7)}g</div>
                                <div class="summary-label">日均蛋白质</div>
                            </div>
                            <div class="summary-item">
                                <div class="summary-value">${Math.round(weeklySummary.totalCarbs / 7)}g</div>
                                <div class="summary-label">日均碳水</div>
                            </div>
                            <div class="summary-item">
                                <div class="summary-value">${weeklySummary.foodVariety.size}+</div>
                                <div class="summary-label">食物种类</div>
                            </div>
                            <div class="summary-item">
                                <div class="summary-value">7 天</div>
                                <div class="summary-label">餐单周期</div>
                            </div>
                        </div>
                        <p style="margin-top: 15px; font-size: 0.95rem; color: var(--text-light);">
                            <i class="fas fa-info-circle"></i> 本周餐单包含${weeklySummary.foodVariety.size}种以上不同食物，确保食物多样性，符合膳食指南建议。
                        </p>
                    </div>
                `;
                
                return weekHTML;
            }
            
            // 计算基础代谢率
            function calculateBMR(age, gender, weight) {
                // 简化版BMR计算
                if (gender === 'male') {
                    return 10 * weight + 6.25 * 170 - 5 * age + 5;
                } else {
                    return 10 * weight + 6.25 * 160 - 5 * age - 161;
                }
            }
            
            // 获取活动系数
            function getActivityFactor(work, exercise) {
                const workFactors = {
                    sedentary: 1.2,
                    light: 1.375,
                    moderate: 1.55,
                    heavy: 1.725
                };
                
                const exerciseFactors = {
                    none: 0.9,
                    light: 1.0,
                    moderate: 1.1,
                    heavy: 1.2
                };
                
                return workFactors[work] * exerciseFactors[exercise];
            }
            
            // 获取饮食类型比例
            function getDietRatios(dietType) {
                switch(dietType) {
                    case 'high-protein':
                        return {proteinRatio: 0.30, carbRatio: 0.40, fatRatio: 0.30};
                    case 'low-carb':
                        return {proteinRatio: 0.25, carbRatio: 0.30, fatRatio: 0.45};
                    case 'vegetarian':
                        return {proteinRatio: 0.20, carbRatio: 0.55, fatRatio: 0.25};
                    default: // balanced
                        return {proteinRatio: 0.20, carbRatio: 0.50, fatRatio: 0.30};
                }
            }
            
            // 生成单日餐单
            function generateDayMeals(dayIndex, dailyCalories, dietType, age, gender) {
                // 每日餐单数据
                const dayPlans = [
                    {
                        dietFocus: "高蛋白早餐搭配丰富午餐，晚餐清淡易消化",
                        meals: [
                            {type: "breakfast", name: "早餐", time: "07:00-08:00", calorieRatio: 0.3},
                            {type: "lunch", name: "午餐", time: "12:00-13:00", calorieRatio: 0.4},
                            {type: "dinner", name: "晚餐", time: "18:00-19:00", calorieRatio: 0.25},
                            {type: "snack", name: "加餐", time: "15:00-16:00", calorieRatio: 0.05}
                        ]
                    },
                    {
                        dietFocus: "富含膳食纤维，促进肠道健康",
                        meals: [
                            {type: "breakfast", name: "早餐", time: "07:00-08:00", calorieRatio: 0.3},
                            {type: "lunch", name: "午餐", time: "12:00-13:00", calorieRatio: 0.4},
                            {type: "dinner", name: "晚餐", time: "18:00-19:00", calorieRatio: 0.25},
                            {type: "snack", name: "加餐", time: "15:00-16:00", calorieRatio: 0.05}
                        ]
                    },
                    {
                        dietFocus: "适量增加健康脂肪摄入，提供持久能量",
                        meals: [
                            {type: "breakfast", name: "早餐", time: "07:00-08:00", calorieRatio: 0.3},
                            {type: "lunch", name: "午餐", time: "12:00-13:00", calorieRatio: 0.4},
                            {type: "dinner", name: "晚餐", time: "18:00-19:00", calorieRatio: 0.25},
                            {type: "snack", name: "加餐", time: "15:00-16:00", calorieRatio: 0.05}
                        ]
                    },
                    {
                        dietFocus: "增加抗氧化物摄入，提升免疫力",
                        meals: [
                            {type: "breakfast", name: "早餐", time: "07:00-08:00", calorieRatio: 0.3},
                            {type: "lunch", name: "午餐", time: "12:00-13:00", calorieRatio: 0.4},
                            {type: "dinner", name: "晚餐", time: "18:00-19:00", calorieRatio: 0.25},
                            {type: "snack", name: "加餐", time: "15:00-16:00", calorieRatio: 0.05}
                        ]
                    },
                    {
                        dietFocus: "增加Omega-3脂肪酸，有益心血管健康",
                        meals: [
                            {type: "breakfast", name: "早餐", time: "07:00-08:00", calorieRatio: 0.3},
                            {type: "lunch", name: "午餐", time: "12:00-13:00", calorieRatio: 0.4},
                            {type: "dinner", name: "晚餐", time: "18:00-19:00", calorieRatio: 0.25},
                            {type: "snack", name: "加餐", time: "15:00-16:00", calorieRatio: 0.05}
                        ]
                    },
                    {
                        dietFocus: "周末轻食，减轻消化负担",
                        meals: [
                            {type: "breakfast", name: "早餐", time: "08:00-09:00", calorieRatio: 0.3},
                            {type: "lunch", name: "午餐", time: "12:30-13:30", calorieRatio: 0.4},
                            {type: "dinner", name: "晚餐", time: "18:30-19:30", calorieRatio: 0.25},
                            {type: "snack", name: "加餐", time: "15:30-16:30", calorieRatio: 0.05}
                        ]
                    },
                    {
                        dietFocus: "家庭餐，营养均衡适合全家享用",
                        meals: [
                            {type: "breakfast", name: "早餐", time: "08:00-09:00", calorieRatio: 0.3},
                            {type: "lunch", name: "午餐", time: "12:30-13:30", calorieRatio: 0.4},
                            {type: "dinner", name: "晚餐", time: "18:30-19:30", calorieRatio: 0.25},
                            {type: "snack", name: "加餐", time: "15:30-16:30", calorieRatio: 0.05}
                        ]
                    }
                ];
                
                const dayPlan = dayPlans[dayIndex];
                let mealsHTML = '';
                let totalProtein = 0, totalCarbs = 0, totalFat = 0, totalCalories = 0;
                const foodItems = [];
                
                // 生成每餐
                dayPlan.meals.forEach(meal => {
                    const mealData = generateMeal(meal.type, dailyCalories * meal.calorieRatio, dayIndex, dietType);
                    
                    mealsHTML += `
                        <div class="meal-card">
                            <div class="meal-title">
                                <div class="meal-name">${meal.name}</div>
                                <div class="meal-time">${meal.time}</div>
                            </div>
                            <p><strong>食物组成：</strong></p>
                            ${mealData.foodsHTML}
                            <div class="nutrients">
                                <div class="nutrient">
                                    <div class="nutrient-value">${mealData.protein}g</div>
                                    <div class="nutrient-label">蛋白质</div>
                                </div>
                                <div class="nutrient">
                                    <div class="nutrient-value">${mealData.carbs}g</div>
                                    <div class="nutrient-label">碳水</div>
                                </div>
                                <div class="nutrient">
                                    <div class="nutrient-value">${mealData.fat}g</div>
                                    <div class="nutrient-label">脂肪</div>
                                </div>
                                <div class="nutrient">
                                    <div class="nutrient-value">${mealData.calories}kcal</div>
                                    <div class="nutrient-label">总能量</div>
                                </div>
                            </div>
                            <p><strong>菜谱建议：</strong> ${mealData.recipe}</p>
                            <button class="recipe-btn" onclick="alert('详细食谱功能正在开发中...')">查看详细食谱</button>
                        </div>
                    `;
                    
                    totalProtein += mealData.protein;
                    totalCarbs += mealData.carbs;
                    totalFat += mealData.fat;
                    totalCalories += mealData.calories;
                    
                    // 收集食物种类
                    mealData.foodNames.forEach(name => foodItems.push(name));
                });
                
                return {
                    meals: mealsHTML,
                    totalProtein: Math.round(totalProtein),
                    totalCarbs: Math.round(totalCarbs),
                    totalFat: Math.round(totalFat),
                    totalCalories: Math.round(totalCalories),
                    dietFocus: dayPlan.dietFocus,
                    foodItems: foodItems
                };
            }
            
            // 生成单餐数据
            function generateMeal(mealType, calories, dayIndex, dietType) {
                // 餐单数据库（简化版）
                const mealDB = {
                    breakfast: [
                        {foods: [
                            {name: '全麦面包', weight: '80g', protein: 8, carbs: 40, fat: 2},
                            {name: '水煮鸡蛋', weight: '1个(50g)', protein: 7, carbs: 1, fat: 5},
                            {name: '牛奶', weight: '200ml', protein: 6, carbs: 10, fat: 4},
                            {name: '苹果', weight: '150g', protein: 0.5, carbs: 20, fat: 0.3}
                        ], recipe: '全麦面包搭配鸡蛋和牛奶，营养全面。苹果提供维生素和膳食纤维。'},
                        {foods: [
                            {name: '燕麦粥', weight: '50g', protein: 7, carbs: 35, fat: 3},
                            {name: '核桃', weight: '20g', protein: 3, carbs: 4, fat: 13},
                            {name: '无糖豆浆', weight: '200ml', protein: 8, carbs: 4, fat: 4},
                            {name: '香蕉', weight: '100g', protein: 1.5, carbs: 22, fat: 0.2}
                        ], recipe: '燕麦粥煮软，加入核桃碎。搭配豆浆和香蕉，提供持久能量。'},
                        {foods: [
                            {name: '全麦馒头', weight: '80g', protein: 8, carbs: 42, fat: 1},
                            {name: '煮鸡蛋', weight: '1个(50g)', protein: 7, carbs: 1, fat: 5},
                            {name: '小米粥', weight: '200g', protein: 4, carbs: 30, fat: 1},
                            {name: '凉拌黄瓜', weight: '100g', protein: 0.8, carbs: 3, fat: 0.2}
                        ], recipe: '全麦馒头搭配鸡蛋和小米粥，黄瓜提供清爽口感。'}
                    ],
                    lunch: [
                        {foods: [
                            {name: '糙米饭', weight: '150g', protein: 4, carbs: 55, fat: 1.5},
                            {name: '清蒸鲈鱼', weight: '120g', protein: 22, carbs: 0, fat: 5},
                            {name: '蒜蓉西兰花', weight: '200g', protein: 5, carbs: 10, fat: 2},
                            {name: '紫菜蛋花汤', weight: '200g', protein: 5, carbs: 2, fat: 1}
                        ], recipe: '鲈鱼清蒸10分钟，西兰花蒜蓉清炒，紫菜蛋花汤简单快捷。'},
                        {foods: [
                            {name: '荞麦面', weight: '120g', protein: 5, carbs: 48, fat: 2},
                            {name: '鸡胸肉', weight: '100g', protein: 24, carbs: 0, fat: 2},
                            {name: '凉拌菠菜', weight: '150g', protein: 4, carbs: 6, fat: 0.5},
                            {name: '番茄鸡蛋汤', weight: '200g', protein: 6, carbs: 5, fat: 3}
                        ], recipe: '荞麦面煮熟，鸡胸肉切片蒸熟，菠菜焯水凉拌。'},
                        {foods: [
                            {name: '红薯', weight: '200g', protein: 4, carbs: 50, fat: 0.4},
                            {name: '烤鸡腿', weight: '120g', protein: 26, carbs: 0, fat: 8},
                            {name: '清炒空心菜', weight: '200g', protein: 5, carbs: 8, fat: 1},
                            {name: '豆腐汤', weight: '200g', protein: 8, carbs: 3, fat: 3}
                        ], recipe: '红薯蒸熟，鸡腿烤箱烤制，空心菜清炒，豆腐汤清淡可口。'}
                    ],
                    dinner: [
                        {foods: [
                            {name: '杂粮粥', weight: '200g', protein: 5, carbs: 30, fat: 1},
                            {name: '鸡胸肉炒彩椒', weight: '150g', protein: 25, carbs: 8, fat: 3},
                            {name: '香菇油菜', weight: '200g', protein: 4, carbs: 10, fat: 2},
                            {name: '凉拌海带丝', weight: '100g', protein: 1.5, carbs: 4, fat: 0.5}
                        ], recipe: '杂粮粥提前浸泡，鸡胸肉切丁快炒，香菇油菜清炒，海带丝凉拌。'},
                        {foods: [
                            {name: '小米粥', weight: '200g', protein: 4, carbs: 35, fat: 1},
                            {name: '清蒸豆腐', weight: '150g', protein: 12, carbs: 5, fat: 7},
                            {name: '蒜蓉生菜', weight: '200g', protein: 3, carbs: 6, fat: 0.5},
                            {name: '蒸南瓜', weight: '100g', protein: 1, carbs: 20, fat: 0.2}
                        ], recipe: '小米粥煮至浓稠，豆腐蒸8分钟，生菜快炒，南瓜蒸熟。'},
                        {foods: [
                            {name: '山药粥', weight: '200g', protein: 4, carbs: 32, fat: 0.8},
                            {name: '清蒸鱼块', weight: '100g', protein: 18, carbs: 0, fat: 4},
                            {name: '凉拌木耳', weight: '150g', protein: 2, carbs: 10, fat: 0.3},
                            {name: '蒸茄子', weight: '150g', protein: 2, carbs: 8, fat: 0.5}
                        ], recipe: '山药粥健脾养胃，鱼块清蒸，木耳泡发凉拌，茄子蒸熟调味。'}
                    ],
                    snack: [
                        {foods: [
                            {name: '无糖酸奶', weight: '100g', protein: 3, carbs: 5, fat: 2},
                            {name: '混合坚果', weight: '20g', protein: 3, carbs: 4, fat: 10}
                        ], recipe: '无糖酸奶可加入少量新鲜水果；坚果选择无盐原味的杏仁、核桃。'},
                        {foods: [
                            {name: '水果沙拉', weight: '150g', protein: 1, carbs: 25, fat: 0.5},
                            {name: '全麦饼干', weight: '30g', protein: 3, carbs: 20, fat: 4}
                        ], recipe: '混合苹果、橙子、葡萄等时令水果，搭配全麦饼干。'},
                        {foods: [
                            {name: '煮毛豆', weight: '80g', protein: 8, carbs: 10, fat: 4},
                            {name: '奇异果', weight: '100g', protein: 1, carbs: 15, fat: 0.5}
                        ], recipe: '毛豆煮熟后加少量盐，奇异果去皮切片。'}
                    ]
                };
                
                // 根据星期和饮食类型选择餐单
                const mealOptions = mealDB[mealType];
                const mealIndex = (dayIndex + (dietType === 'high-protein' ? 0 : dietType === 'low-carb' ? 1 : 2)) % mealOptions.length;
                const meal = mealOptions[mealIndex];
                
                let foodsHTML = '';
                let totalProtein = 0, totalCarbs = 0, totalFat = 0;
                const foodNames = [];
                
                meal.foods.forEach(food => {
                    foodsHTML += `
                        <div class="food-item">
                            <div class="food-name">${food.name}</div>
                            <div class="food-weight">${food.weight}</div>
                        </div>
                    `;
                    totalProtein += food.protein;
                    totalCarbs += food.carbs;
                    totalFat += food.fat;
                    foodNames.push(food.name);
                });
                
                const totalCalories = totalProtein * 4 + totalCarbs * 4 + totalFat * 9;
                
                return {
                    foodsHTML: foodsHTML,
                    protein: Math.round(totalProtein),
                    carbs: Math.round(totalCarbs),
                    fat: Math.round(totalFat),
                    calories: Math.round(totalCalories),
                    recipe: meal.recipe,
                    foodNames: foodNames
                };
            }
        });
    </script>
</body>
</html>